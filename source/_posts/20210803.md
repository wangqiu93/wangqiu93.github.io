---
title: 车辆监控平台
category: 综合模块
tag: 项目
---

## 架构图
![车辆监控架构图](/img/posts/车辆监控平台架构.png)

## 业务
1. 销售车辆50W，同时在线数高峰：6W。
2. 车辆正常情况下每10s发送一条报文到监控平台。
3. 数据情况：
    1. 车辆原始报文大小1K。
    2. 车辆解析后车况大小6K。
    3. 平均一台车每天会产生10MB的数据。
    4. 系统每天会产生5T的数据。
    5. 同时系统有7.2亿行的数据需要写入到数据库。
4. 系统并发量
    1. 持续并发量：6000。
    2. 长连接：6W。
    3. 每秒6M的原始数据需要被解析。
    4. 每秒35M的解析数据需要被存储。

## 微服务
配置：4C8G
服务情况（7天内Grafana）
* 最新车况：5个节点，QPS-300req/s，p99-50ms。
* 最新位置：4个节点，QPS-160req/s，p99-24ms。
* 历史车况：5个节点。
* 历史位置：6个节点。
* 驾驶行为：5个节点。
* 车辆告警：5个节点。

## Kafka
* 版本：1.1.1
* 磁盘容量：15000GB
* 带宽：600MB/s

## HBase
### 组件版本
* webappproxy：1.0
* zookeeper：3.4.9
* hdfs：2.8.4
* yarn：2.8.4
* hbase：1.3.1
* knox：1.2.0

### HBase节点信息
* Common：节点-**3**，CPU-4核，内存-8G，高效云盘-100G
* Core：节点-**20**，CPU-8核，内存-32G，本地盘-11176G * 4
* Master：节点-**2**，CPU-4核，内存-16G，高效云盘-100G
* 存储总量：810.33TB，已使用：**17.5%**

### Zookeeper
三个节点

### 消息保留
默认时长：1天

## Mongo
集群类型：副本集，主从架构
节点规格：共3个节点，每个节点-24核128GB内存，1500存。

## Redis
版本：5.0
内存容量：16G，已用6.29GB(39.1%)
内存配置：1分片/16GB/3副本

## MySQL
版本：5.7
架构：主从+灾备
配置：8核32000MB内存，200GB存储空间，已使用60.641GB






